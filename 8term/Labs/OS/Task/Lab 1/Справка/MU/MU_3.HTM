<html>
<title>Методические указания</title>
<head><H2 ALIGN=CENTER>Методические указания к работе №3</H2></head>

<body BGCOLOR="#FF0FFF" TEXT="#000000" LINK="#FF0000" ALINK="A52A2A">

<H3>Теоретическая часть</H3>
В составе IBM PC имеется таймер, служащий для отсчёта текущего времени и работающий с частотой 1.193 МГц. 
Сигналы таймера после пересчёта 65535:1 поступают в контроллер прерываний и инициируют
 прерывания через вектор 8 с частотой 18.2  1/с. Отсчёт текущего времени ведётся системным обработчиком BIOS.
<P>Для того, чтобы прикладные программы могли использовать сигналы таймера, не разрушая при этом работу системных часов, 
в обработчик BIOS включен вызов INT 1Ch, передающий управление на программу-заглушку BIOS, содержащую единственную строку IRET. 
Пользователь может записать в вектор 1Ch адрес 
прикладного обработчика сигналов таймера и использовать в своей программе средства реального времени. 
<P>Таймер принимает участие в программировании звука вместе с одним из портов контроллера клавиатуры, управляющего работой клавиатуры и динамика.
<IMG SRC="Pic/8.bmp" ALT="Картинка">
<P>Рисунок 4.3 - Элементы компьютера, принимающие участие в генерации звука

<P>Подсистема таймера работает независимо от процессора, от собственного генератора. Таймер имеет три независимых канала, каждый из которых можно независимо перепрограммировать. Для управления режимами программирования в подсистеме таймера имеется регистр команд, обращение к которому осуществляется через порт 43h.
Ниже приведён пример программы, которая генерирует тон.

<P>;Управление звуком от таймера. Генерация тона.
<P>;Установим режим таймера
<P>mov al,0b6h   ; управляющее слово
<P>out 43h,al       ;выведем его в регистр команд
<P>;Установим частоту канала 2 таймера
<P>mov ax,11930 ;1193000/11930 =100 Гц
<P>out 42h,al       ;младший байт в порт
<P>mov al,ah
<P>out 42h,al       ;старший байт в порт
<P>in al,61h         ; введём содержимое порта 61h
<P>or al,3             ;установим биты 0 и 1
<P>out 61h,al       ;выведем в порт
<P>delay 50
<P>and al,11111100bh ;сбросим биты 0 и 1 
<P>out 61h,al               ;выведем в порт
<P>Компьютеры типа IBM PC оснащаются КМОП-микросхемами с батарейным питанием, которая служит, с одной стороны,
 для хранения информации о конфигурации компьютера,
 а с другой - для отсчёта реального календарного времени. Поскольку эта
 микросхема питается от встроенной батарейки, часы реального времени продолжают работать, даже при выключенном компьютере.
 В процессе начальной загрузки программы  DOS считывают показания часов реального времени, 
сохраняют их в ячейках системной области и модифицируют в дальнейшем эти ячейки в соответствии с ходом работы системного таймера.
<P>Для чтения и изменения показаний часов реального времени в КМОП-микросхеме используется прерывание BIOS  1Ah.Также используются функции  DOS:
<LI> 2Ah - получить дату; 
<LI> 2Bh - установить дату;
<LI> 2Ch -получить время;
<LI> 2Dh - установить время.
<P>Время в КМОП-микросхеме храниться в упакованном двоично-десятичном формате, причём и при получении, и при установке времени число часов
находиться в регистре CH, 
число минут - в CL и число секунд в - DH. 
Упакованное BCD число представляет последовательность полубайт.
 Каждый полубайт содержит соответствующую цифру. Неупакованный BCD формат представляет 
собой последовательность байт, где каждый байт представляет одну цифру. Если к каждому
 такому байту добавить 48, то мы получим фактическую цепочку символов, отображающих данное число.

<H3>Порядок выполнения работы</H3>
<P>1.Ознакомиться с теоретическим материалом, приведённым в методических указаниях.
<P>2.Запустить на выполнение пример и ознакомиться с демонстрационными программами.
<P>3.Получить у преподавателя номер варианта и задание по нему, которое приведено в лабораторном комплексе.
<P>4.Разработать предварительный алгоритм программы.
<P>5.В текстовом редакторе  ввести текст исходной программы.
<P>6.Запустить на выполнение программу TASM.EXE, если есть ошибки, то вернуться к пункту 4.
<P>7.Запустить на выполнение программу TLINK.EXE, если есть ошибки, то вернуться к пункту 4.
<P>8.Запустить на выполнение программу TD.EXE, если есть ошибки, то вернуться к пункту 4.
<P>9. Получить контрольные вопросы.
<P>10.Подготовить ответы на вопрсы.
<P>11.Оформить отчёт.
<P>12.Защитить лабораторную работу.

