                          ВЕКТОРА ПРЕРЫВАНИЙ

     Семейство компьютеров IBM в значительной  степени  управляется  с
помощью прерываний,  генерируемых аппаратным и программным обеспечени-
ем,  т.е.  в реальном режиме имеется 2 типа прерываний:  аппаратные  и
программные. Программные прерывания инициируются командой INT аппарат-
ные - внешними событиями,асинхронными по отношению к выполняемой прог-
рамме. Обычно аппаратные прерывания инициируются аппаратурой ввода-вы-
вода после завершения выполнения текущей операции.
     Кроме того,некоторые прерывания зарезервированы для использования
самим процессором.
     Для обработки прерываний в реальном режиме  процессор  использует
таблицу векторов прерываний. Сегментные адреса, используемые для опре-
деления местоположения программ обработки прерываний,  называются век-
торами  прерываний.  Таблица векторов прерываний располагается в самом
начале оперативной памяти, т.е. ее физический адрес - 00000.
     Таблица векторов прерываний состоит из 256 элементов по 4  байта,
поэтому  ее размер составляет 1 Кбайт.  Вектора состоят из 16-битового
сегментного адреса процедуры обработки прерываний и 16-битового смеще-
ния. Смещение хранится по младшему адресу, сегментный адрес - по стар-
шему.  Каждый вектор прерывания имеет свой номер,  называемый  номером
прерывания,  который указывает на его место в таблице. Этот номер, ум-
ноженный на 4 дает абсолютный адрес первого байта  вектора  в  рабочей
памяти.
     Вектора прерываний получают свои значения при запуске системы, но
позже пользователь может их изменить.  Сначала управление передается к
BIOS. BIOS выполняет серию тестов и  процедур  инициализации,  задавая
значения определенных векторов прерываний.  После этого BIOS выполняет
процедуру начальной загрузки и передает управление DOS,  которая также
задает значения определенным векторам.  Кроме того,  DOS переназначает
некоторые из векторов BIOS к своим подпрограммам.

                  СПРАВОЧНЫЕ ДАННЫЕ ПО ФУНКЦИЯМ DOS

INT 21h, Функция 01h - ввод с клавиатуры с эхо.
     На входе: AH - 01h
     На выходе: AL - байт входных данных
Функция ожидает ввод со стандартного входного устройства. Если получен
ASCII символ,  он выводится на стандартное выходное устройство и запи-
сывается в AL.  Если после выполнения функции AL содержит 00Н, это оз-
начает,  что получен расширенный ASCII код, второй байт которого будет
прочитан при следующем выполнении функции. При выполнении функции осу-
ществляется проверка наличия Ctrl-Break.

INT 21h, Функция 02h вывод символов на экран через стандартный поток.
    На входе: АН = 02h
              DL = ASCII-код выводимого символа
    Функция обрабатывает нажатие кjgeлавиш Ctrl-Break.
ч
INT 21h,  Функция 05h - вывод на принтер.
    На входе: АН = 05h
              DL - символ, выводимый на стандартное устройство.

INT 21h,  Функция  06h - прямой ввод-вывод на консоль.
    На входе:  AН = 06h
Регистр AL используется для ввода,  а регистр DL - для вывода. Если DL
содержит FFH, выполняется ввод и регистр AL готов принять входной сим-
вол.  Состояние флага ZF показывает наличие символа.  Если ZF содержит
1,  то нет символа и значение AL несущественно.Если ZF содержит 0,  то
имеется символ и он записывается в AL.  Если значение  DL  отлично  от
FFH, выполняется вывод. DL содержит ASCII код символа. Функция 06Н ра-
ботает со стандартными входным и  выходным  устройствами.  Функция  не
ожидает появления входного символа, читает без эхо и при ее выполнении
не проверяется наличие Ctrl-Break.

INT 21h,  Функция 07h - прямой ввод с клавиатуры без эхо.
    На входе: AH = 07h
    На выходе: AL - ASCII-код вводимого символа
Аналогична функции 01Н,  но работает без эхо и при  ее  выполнении  не
проверяется наличие Ctrl-Break.

INT 21h, Функция 08h  - ввод с клавиатуры без эхо
    На входе: AH = 08h
    На выходе: AL - ASCII-код вводимого символа
Аналогична функции 01Н но работает без  эхо.  При  отсутствии  символа
ждет ввода. Для чтения расширенного кода ASCII требуется повторное вы-
полнение функции.

INT 21h, Функция 09h  - вывод строки на экран дисплея.
    На входе: АН = 09h
              DS:DX = адрес отображаемой строки.
Строка отображается  начиная с текущей позиции курсора.  Строка должна
оканчиваться символом '$' (код ASCII 24h).  Строка может включать  уп-
равляющие символы. Функция обрабатывает нажатие клавиш Ctrl-Break.

INT 21h, Функция 0Аh  -  буферизованный ввод с клавиатуры.
    На входе: АН = 0Аh
              DS:DX = адрес буфера.
    На выходе: Данные помещены в буфер в формате:
     байт 0 - максимальное количество символов, которые могут быть об-
              работаны
     байт 1 - фактическая длина введенной строки
     байт 2 и т.д. - строка, заканчивающаяся символом 0Dh.
Функция дает  возможность использовать в программе стандартные клавиши
для редактирования командной строки.  Конечный результат  представляет
цепочку, которая получается в буфере ввода после нажатия клавиши Enter
или после получения символа 0Dh от стандартного  входного  устройства.
Максимальное количество символов,  которое можно поместить в буфер, на
единицу меньше значения его первого байта - одна позиция  зарезервиро-
вана  для  символа 0Dh.  При превышении этого максимума DOS игнорирует
дальнейший ввод и выдает звуковой сигнал при вводе каждого последующе-
го символа. При выполнении функции проверяется наличие Ctrl-Break.

INT 21h,  Функция 0Вh  -  проверка входного статуса клавиатуры.
    На входе: AН - 0Bh
    На выходе:  FFh, если есть символ на входном устройстве
                00h, если нет  символа.
При выполнении функции проверяется наличие Ctrl-Break.

INT 21h,  Функция  0Сh  -  стирает  буфер клавиатурного драйвера BIOS,
после чего выполняет указанную в регистре AL функцию.  Допустимы функ-
ции 01h, 06h, 07h, 08h и 0Аh. При выполнении функции проверяется нали-
чие Ctrl-Break.

INT 21h,  Функция 0Dh - очищение дисковых буферов.
Открытые файлы не закрываются.

INT 21h,  Функция 0Eh - смена текущего диска.
     На входе: DL - номер нового текущего диска.
     На выходе: AL - максимальное количество логических дисков, как оно
определено  командой LASTDRIVE в CONFIG.SYS.  По умолчанию LASTDRIVE=5
(максимум 5 логических дисков).

INT 21h, Функция 19h - получение текущего диска.
     На входе: АН - 19h
     На выходе: AL - номер текущего диска.

INT 21h, Функция 1Ah - изменение адреса области обмена с диском (DTA).
     На входе: AH - 19h
               DS:DX - адрес DTA
При запуске  программы  адрес DTA указывает смещение 80Н с начала PSP.
При помощи этой функции DTA можно поместить в область пользовательской
программы.

INT 21h, Функция 1Bh - информация о текущем диске.
     На входе: АН - 1Bh
     На выходе: AL - количество секторов в кластере
                CX - количество байтов в секторе
                DX - общее количество кластеров на диске
                DS:BX - указатель к идентификатору формата диска.:
                   FD - дискета 360 Кбайт
                   F9 - дискета 1.2 Мбайт
                   FB - дискета 1.44 Мбайт
                   F8 - жесткий диск

INT 21h, Функция 1Сh - информация о заданном диске.
     На входе: AH - 1Ch
               DL - номер диска (0 - текущий, 1 - А и т.д.)
     На выходе: AL - количество секторов в одном кластере
                DX - количество кластеров на диске
                CX - размер сектора
                DS:BX - указатель к идентификатору формата диска.
DS:BX содержит адрес одного байта в рабочих областях DOS,  который яв-
ляется  копией идентификатора формата диска из FAT.  На самом деле это
адрес начала копии FAT в рабочих областях DOS.

INT 21h, Функция 1Fh - получение адреса блока параметров текущего диска
     На входе: AH - 1Fh
     На выходе: AL - 00h - успешное выполнение
                DS:BX - адрес блока параметров диска

INT 21h, Функция 25h - изменение вектора прерывания.
     На входе: AH - 25h
               AL - номер вектора прерывания
     На выходе: DS:DX - адрес новой программы обработки прерываний.

INT 21h, Функции 26h - создание PSP.
     На входе: AH - 26h
               DX - сегментный адрес  для нового PSP.
PSP текущего  процесса копируется целиком в область для нового PSP.  В
новом PSP обновляется информация о размере сегмента программы,  распо-
ложенная  со смещением 6.  Обновляются также поля 5,6,7 (INT 22h,  INT
23h, INT 24h) текущим содержанием соответствующих векторов прерываний.

INT 21h, Функция 2Аh - получение системной даты.
     На входе: AH - 2Ah
     На  выходе:  AL - день недели (0 - воскресенье;  6 - суббота)
                  CX - год (1980 -2099)
                  DH - месяц (1 -12)
                  DL - число(1 -31)
INT 21h, Функция 2Вh - изменение даты.
     На входе: АН - 2Bh
               СХ - год
               DH - месяц
               DL - число
     На выходе: АL - 00, если дата действительна
                     FFh - если дата недействительна.

INT 21h, Функция 2Сh - получение системного времени.
     На входе: AH 2Ch
     На выходе: СН - часы (0-23)
                CL - минуты (0-59)
                DH - секунды (0-59)
                DL - сотые доли секунды (0-99)
Значения CH, CL, DH, DL вычисляются из значения счетчика BIOS для вре-
мени с начала суток. DOS реагирует на вырабатываемый BIOS сигнал смены
суток и изменяет дату каждые 24 часа.

INT 21h, Функция 2Dh - изменение системного времени.
     На входе: AH -2Dh
               CH - часы (0-23)
               CL - минуты (0-59)
               DH - секунды (0-59)
               DL - сотые доли секунды (0-99).
     На выходе: АL - 00, если время действительно
                     FFh - если время недействительно.

INT 21h, Функция 2Еh - проверка при записи на диск (VERIFY ON/OFF)
     На входе: АL - 01 активирует проверку при записи
                    00  дезактивирует проверку при записи
При активизации проверки после каждой операции записи на диск осущест-
вляется контрольное чтение.

INT 21h  Функция 2Fh - получение адреса области обмена с диском (DTA).
     На входе: AH - 2Fh
     На выходе:  ES:BX - адрес DTA

INT 21h, Функция 30h - получение версии DOS.
     На входе: AH - 30h
     На выходе:  AL - номер версии
                 АН - модификация
                 ВХ и СХ содержат нули

INT 21h, Функция 31h - завершиться и остаться резидентной.
     На входе: AH - 31h
               AL - код завершения
               DX - размер резидентной части в параграфах.
Программа (или часть ее) может остаться резидентной в памяти  и  после
завершения.  Блоки памяти, принадлежащие программе, не освобождаются -
обычно только уменьшается блок,  в котором она была загружена. Сбрасы-
ваются на диск буферы, открытые программой файлы закрываются. Значения
векторов 22Н,  23Н,  и 24Н восстанавливаются из соответствующих  полей
PSP. Управление передается по адресу завершения (вектор 22Н).

INT 21h,  Функция 32h - получение адреса блоков параметров заданного
                        диска
     На входе: AH - 32h
               DL - номер диска
     На выходе: AL - 00h - успешное выполнение
                AL - FFh - недопустимый дисковод
                DS:BX - адрес блока параметров диска

INT 21h, Функции 33h, подфункции 00h и 01h - проверка или установка
                      Ctrl-Break (BREAK=ON/OFF).
     На входе: AH - 33h
               AL = 00 - информация о текущем состоянии флага про-
                         верки
                    01 - изменяет флаг проверки в соответствии с DL.
               DL = 00 - дезактивирует проверку
                    01 - активирует проверку
     На выходе: DL - текущее состояние флага, если при входе: AL=00
                    00 - проверка не осуществляется (флаг опущен)
                    01 - проверка активна (флаг поднят).
Функция аналогична  команде DOS BREAK=ON/OFF.  Когда флаг для проверки
установлен в 0,  DOS проверяет наличие Ctrl-Break и Ctrl-C только  при
выполнении  системных функций DOS 01h-0Ch (без 06h и 07h).  Когда флаг
установлен в 1,  проверка осуществляется  и  при  остальных  системных
функциях.
                      
INT 21h, Функции 33h, подфункция 05h - получение дисковода загрузки.
     На входе: AH - 33h
               AL - 05h
     На выходе: DL - дисковод загрузки (1=А:, и т.д.)
     
INT 21h, Функция 34h - получение адреса флага занятости.
     На входе: AH - 34h
     На выходе: ES:BX - адрес однобайтового флага InDOS
Возвращает адрес байта области текущих данных DOS  (SDA),  содержащего
флаг InDOS.

INT 21h, Функция 35h - значение вектора прерывания.
     На входе: AH - 35h
               AL - номер вектора прерывания
     На выходе: ES:BX - номер вектора прерывания
Функция сохраняет значение вектора, перед изменениям его функцией 25h,
чтобы можно было восстановить его позднее.

INT 21h  Функция 36h - информация о свободном пространстве на диске.
     На входе:  AH - 36h
                DL - номер диска
     На выходе: ВХ - количество свободных кластеров
                DX - общее количество кластеров на диске
                СХ - размер сектора (в байтах)
                АХ - количество секторов в одном кластере
                    FFFFh, если номер диска в DL недействителен

INT 21h, Функция 39h - создание каталога (МкDir)
INT 21h, Функция 3Аh - удаление каталога (RmDir)
INT 21h, Функция 3Вh - смена каталога (СhDir)
     На входе: АН - номер функции
               DS:DX - указатель к ASCIIZ-цепочке (файловая спецификация)
     На выходе: АХ - код ошибки, если CF=1
Функции аналогичны соответствующим командам DOS - MD,  RD и CD. Нельзя
удалить текущий каталог или каталог, содержащий файлы или  каталоги.

INT 21h, Функция 3Сh - создание файла (CREATE).
     На входе: АН - 3Ch
               DS:DX - указатель к ASCIIZ-цепочке (файловая спецификация)
               СХ (CL) - атрибуты файла
     На выходе: АХ - код ошибки, если CF=1
                     файловый дескриптор, если CF=0

INT 21h, Функция 3Dh - открытие файла (OPEN)
     На входе: АН - 3Dh
               DS:DX - указатель к ASCIIZ-цепочке (файловая спецификация)
               AL - режим открытия (код доступа)
     На выходе: АХ - код ошибки, если CF=1
                     файловый дескриптор, если CF=0
Файл должен  существовать.  Не  допускается указание группового имени.
Указатель текущкей позиции в файле  устанавливается в начало файла.
 ┌─────────────────────────────────────────────────────┐
 │ 7 6 5 4 3 2 1 0    НАЗНАЧЕНИЕ                       │
 ├─────────────────────────────────────────────────────┤
 │ . . . . . Д Д Д    Режим доступа                    │
 │ . . . . Р . . .    Резервный                        │
 │ . П П П . . . .    Режим совместного использования  │
 │ Н . . . . . . .    Режим наследования               │
 └─────────────────────────────────────────────────────┘

     Режим доступа - биты 0-2.  Определяют права доступа  программы  к
файлу: (000) - только для чтения;  (001) - только для записи;  (010) -
для чтения и записи. Другие комбинации не допускаются.
     Режим наследования  -  бит  7.  Указывает,  как  файл  может быть
использован порожденным процессом.  Если бит 7  равен  0,  порожденный
процесс наследует все открытые родительским процессом файлы в их теку-
щем состоянии и с тем же режимом доступа.  Если бит 7 равен 1,  порож-
денный процесс  выполняется как независимая программа и может работать
с файлом в соответствии с режимом совместного использования,  заданным
при его открытии родительским процессом.
     Режим совместного использования  -  биты  4-6.  Определяют  право
доступа к файлу для других процессов, которые пытаются открыть файл до
его закрытия главным процессом,  DOS следит за соблюдением режима сов-
местного использования файлов, только если в памяти загружен специаль-
ный резидентный модуль. Один и тот же файл можно открыть многократно в
одном и том же процессе.  При каждом открытии создается новый блок уп-
равления и получается новый файловый  дескриптор.  Возможны  следующие
коды ошибок:  2 - файл не обнаружен, 3 - нет такого пути, 4 - нет сво-
бодного файлового дескриптора, 5 - отказан доступ, 12 - недействитель-
ный код доступа.

INT 21h, Функция 3Eh - закрытие файла (СLOSE)
     На входе: АН - 3Eh
               DS:DX - файловый дескриптор (полученный при открытии
                       или создании файла)
     На выходе: АХ - код ошибки, если CF=1
Каталог изменяется.  Буферы DOS,  содержащие записи для  этого  файла,
очищаются. Возможен код ошибки 6 - недействительный файловый дискриптор

INT 21h  Функция 3Fh - чтение из файла или устройства.
INT 21h  Функция 40Н - запись в файл или устройство
     На входе: АН - номер функции
               ВХ -  файловый  дескриптор,  полученный при открытии
                     или создании файла
               СХ: - количество байтов (размер записи)
               DS:DX - адрес по которому нужно записать прочитанную
                       запись
     На выходе: АХ - код ошибки, если CF=1 или
                     количество действительно прочитанных записанных
                     байтов.
Функция читает/записывает  указанное количество байтов с текущей пози-
ции в файле (FP).  После операции значение FP увеличивается  на  коли-
чество прочитанных/записанных байтов.  Количество действительно прочи-
танных/записанных байтов не всегда  равно  указанному.  Например,  при
достижении  конца  файла  или при чтении с клавиатуры,  можно прочесть
максимум одну строку (до нажатия Enter),  независимо от указанного ко-
личества байтов для чтения.  Коды ошибок: 5 - отказан доступ и 6 - не-
действительный файловый дескриптор).

INT 21h,  Функция 41Н - удаление файла.
     На входе: АН - 41h
               DS:DX - указатель к ASCIIZ-цепочке (файловая спецификация)
     На выходе: АХ - код ошибки, если CF=1

INT 21h, Функция 42h - перемещение текущего указателя в файле (Move FP).
     На входе: АН - 42h
               ВХ -  файловый  дескриптор,  полученный при открытии
                     или создании файла
               СХ:DX - смещение относительно текущей позиции в байтах
                       интерпретируется как 32-битовое целое число без
                       знака
               AL - метод перемещения
     На выходе: АХ - код ошибки, если CF=1
                DX:AX - новое значение указателя
    AL может иметь следующие значения:
     0 - смещение считается от начала файла. Если CX:DX=0, FP указыва-
         ет на начало файла.
     1 - смещение считается от текущей позиции FP.
     2 - Смещение считается от конца файла.  Если CX:DX=0, в DX:AX по-
         лучается длина файла в байтах.
     Возможны следующие коды ошибок:  1 - недействительный номер функ-
ции; 6 - недействительный файловый дескриптор.

INT 21h  Функция 43h - получение или изменение атрибутов файла
     На входе: АН - 43h
               DS:DX - указатель к ASCIIZ-цепочке (файловая спецификация)
               СХ - атрибуты файла
               АL - 00 - информация об атрибутах
                    01 - изменение атрибутов
     На выходе: АХ - код ошибки, если CF=1
                СХ - атрибуты файла, если CF=0 и на входе: AL=00h
Атрибуты описаны в каталоге. Атрибуты 08Н (метка тома) и 10Н (каталог)
нельзя изменять.  Коды ошибок:  1 - недействительная функция, 2 - файл
не обнаружен, 3 - нет такого пути, 5 - отказан доступ.

INT 21h  Функция 45h - копирование файлового дескриптора.
     На входе: АН - 45h
               ВХ -  файловый  дескриптор
     На выходе: АХ - код ошибки, если CF=1
                     новый файловый дескриптор, если CF=0
Функция дублирует открытый файловый дескриптор.  В результате по-
лучаются два файловых дескриптора, идентифицирующих один и тот же блок
управления DOS, который создан при открытии файла. Следовательно, Если
значение FP для одного из дескрипторов изменится, соответственно изме-
няется значение  FP  и для другого дескриптора.  Коды ошибок:  4 - нет
свободного дескриптора, 6 - недействительный файловый дескриптор.

INT 21h  Функция 46Н - перенаправить файловый дескриптор.
     На входе: АН - номер функции
               ВХ - файловый  дескриптор или устройство
               СХ - перенаправляемый дескриптор
     На выходе: АХ - код ошибки, если CF=1
Получив два  дескриптора,  функция заставляет второй дескриптор указы-
вать на то же устройство или ту же позицию в файле, что и первый деск-
риптор.  Если  переданный  в  СХ  дескриптор уже указывает на открытый
файл,  то этот файл сначала закрывается. Операции поиска, чтения и за-
писи,  изменяющие  положение указателя файла для одного для двух деск-
рипторов,  одновременно изменяют положение указателя файла, связанного
с другим дескриптором.

INT 21h, Функция 47h - информация о текущем каталоге
     На входе: АН - 47h
               DL - код дисковода
               DS:SI - адрес буфера длиной 64 байта
     На выходе: АХ - код ошибки, если CF=1
               DS:SI -  по  этому  адресу записывается полная файловая
          спецификация (путь от корневого каталога)  текущего каталога.
Имя дискового устройства не включается в полученную файловую  специфи-
кацию  и файловая спецификация не содержит начальный символ "/" - т.е.
если текущим является корневой каталог,  возвращается  пустая  строка.
Код ошибки 15 - недействительное имя устройства.

INT 21h, Функция 48h - выделение блока памяти.
     На входе: AH - 48h
               ВХ - размер блока в параграфах
     На выходе: АХ - сегментный адрес блока или
                     код ошибки, если флаг переноса СF = 1;
                ВХ - размер наибольшего свободного блока, если запрос
                     не может быть выполнен.
Возможны следующие коды ошибок: 7 - недействительный блок в памяти и
8 - не хватает памяти.

INT 21h, Функция 49h - освобождение выделенной памяти.
     На входе: AH - 49h
               ES - сегментный адрес блока, который нужно освободить.
     На выходе: АХ содержит код ошибки, если CF=1.
Таким способом можно освободить любой из блоков в цепочке, но при этом
предполагается,  что программа будет освобождать только блоки, которые
принадлежат ей. Это блоки, которые она получила при помощи функции для
выделения памяти,  блок ее окружения, а также блок, в котором она заг-
ружена. Программа не может освободить блок, который не принадлежит ей,
поскольку  не  располагает  средствами для получения его адреса.  Коды
ошибок:  7 - недействительный блок в памяти и 9 - недействительный ад-
рес блока.

INT 21h, Функция 4Аh - изменение блока памяти (SETBLOCK).
     На входе: AH - 4Ah
               ES - сегментный адрес блока,  который нужно изменить,
               ВХ - новый размер блока в параграфах
     На выходе:  АХ - код ошибки, если CF=1;
                 BX - размер наибольшего доступного блока,
                      если запрос не может быть выполнен.
При помощи этой функции можно  уменьшить  или  расширить  существующий
блок.  Используется  преимущественно  для  обеспечения места для новой
программы, когда блок активной программы нужно уменьшить. Таким спосо-
бом можно изменить любой из блоков в цепочке.  Но предполагается,  что
программа будет изменять только принадлежащие ей блоки.

INT 21h,  Функция 4Вh - ЕХЕС - загрузка и выполнение  одной  программы
                        другой программой
     На  входе: AH - 4Bh
                DS:DX - указатель  к ASCIIZ цепочке
                ES:BX - адрес блока параметров загрузки
                AL - номер подфункции
                     00 - загрузить и выполнить программу
                     01 - загрузить и не выполнять программу
                     03 - загрузить оверлейную программу
     На выходе: АХ - код ошибки,  если CF=1
Используя эту функцию программа может  загрузить  и  выполнить  другую
программу, затем получить обратно управление, может выполнить внутрен-
нюю команду DOS,  а также можно загрузить программу без построения PSP
для нее и не передавая ей управление. Эта возможность позволяет реали-
зовать программы с оверлейной структурой.

INT 21h, Функция 4Сh - завершение процесса с кодом завершения.
     На входе: AH - 4Ch
               AL - код  завершения.
Значение AL запоминается DOS в системную переменную и его можно  полу-
чить позднее при помощи сиcтемной функции 4Dh.  Таким способом процесс
может передать информацию о коде завершения своему родительскому  про-
цессу. Освобождается  вся выделенная процессу память,  закрываются все
открытые файлы, из ячеек PSP восстанавливаются векторы 22h, 23h, 24h.

INT 21h, Функции 4Dh - информация о коде завершения (WAIT).
     На входе: AH - 4Dh
     На выходе: АН может содержать следующие значения:
                     00h - нормальное завершение
                     01h - завершение по Ctrl-Break
                     02h - завершение в результате критической ошибки
                     03h - Завершение резидентной программы
                AL - код возврата, передаваемый из дочернего процесса
Функция возвращает код завершения,  установленный при последнем выпол-
нении функции 4СН или функции 31Н.

INT 21h  Функция 4Еh - поиск первого совпадающего файла
     На входе: АН - 4Eh
               DS:DX - указатель к ASCIIZ-цепочке (файловая спецификация)
               СХ - атрибуты файла, используемые при поиске
     На выходе: АХ - код ошибки, если CF=1
Используя функцию  4ЕН,  можно  искать  конкретный  файл или первый из
группы файлов.  Можно указать произвольные устройство и  каталог.  До-
пускаются  символы  '?'  и  '*'.  При  обнаружении  файла,  DTA (байты
1Eh...2Ah) заполняется следующей информацией:
     21 байт - зарезервированы для последующего поиска функцией 4FH
      1 байт - атрибуты файла
               1  - только для чтения
               2  - скрытый
               4  - системный
               8  - метка тома
              10h - каталог
              20h - атрибут архивации
      2 байта - время (из каталога)
      2 байта - дата (из каталога)
      2 байта - размер файла (младшая часть)
      2 байта - размер файла (старшая часть)
     13 байт - имя обнаруженного файла.
     Коды ошибок 2 - файл не обнаружен, 18 - нет больше файлов.

INT 21h  Функция 4FH - поиск следующего совпадающего файла
     На входе: АН - номер функции
               DTA - информация из последней операции поиска.
Перед выполнением  данной  функции нужно успешно завершить функцию 4ЕН
или 4FH.  Необходимая для ее работы информация находится в  DTA  и  не
следует выполнять операции,  которые могут ее разрушить. Информация об
обнаруженном файле записывается в DTA так же как для функции 4ЕН.  Код
ошибки 18 - нет больше файлов.

INT 21h, Функция 50h - установка идентификатора текущего процесса.
     На входе: AH - 50h
               BX - сегментный адрес PSP  процесса, который становится
                   текущим
Позволяет записать  в  область текущих данных DOS адрес PSP программы,
которую требуется об'явить текущей.

INT 21h, Функция 51h - получение идентификатора текущего процесса.
     На входе: AH - 51h
     На выходе: BX - сегментный адрес PSP текущего процесса
Позволяет получить адрес PSP текущей программы.

INT 21h, Функция 52h -  получение адреса списка списков
                        (недокументирована)
     На  входе: AH - 52h
     На выходе: ES:BX - адрес списка списков
Возвращает адрес "списка списков" - базовой системной таблицы,  содер-
жащей информацию о ряде других таблиц DOS.

INT 21h, Функция  54h - информация о текущем состоянии флага проверки
                        при записи на диск.
     На входе: AH - 54h
     На выходе: AL - 00 нет проверки
                     01 есть проверка

INT 21h  Функция 56h - переименование файла.
     На входе: АН - 56h
               DS:DX - указатель к ASCIIZ-цепочке (файловая
                       спецификация) - старое имя
               ЕS:DI - указатель к ASCIIZ-цепочке (файловая
                       спецификация) - новое имя
     На выходе: АХ - код ошибки, если CF=1
Имя устройства  в  старой  и новой файловой спецификации должны совпа-
дать.  Пути могут быть различными - в этом случае файл меняет свой ка-
талог. Групповые имена не допускаются.

INT 21h, Функция 57Н - изменение/получение информации о дате и времени.
     На входе: АН - номер функции
               ВХ -  файловый  дескриптор
               АL - 00 - информация о дате и времени
                    01 - изменение даты и времени
               СХ - новое время, если AL=01h
               DХ - новая дата, если AL=01h
     На выходе: АХ - код ошибки, если CF=1
                СХ - время, если AL=00h
                DХ - дата, если AL=00h
     Коды ошибок 1 - недействительная функция,  6  -  недействительный
файловый дескриптор.

INT 21h, Функция 59h - расширенная информация об ошибке.
     На входе: АН - 59h
               ВХ - 0000h
     На выходе: АХ - код ошибки
                ВН - класс ошибки
                BL - возможные действмя
                СН - место ошибки
Функцию можно использовать в следующих случаях:
     - в процедуре обработки критических ошибок
     - после  выполнения  традиционной  системной   функции,   которая
использует метод FCB и AL=FFh как индикацию ошибки
     - после выполнения расширенной системной функции, которая исполь-
зует CF=1 как индикацию ошибки.
Код ошибки: см. приложение.
Класс ошибки:
     01h Ресурс исчерпан (не хватает места, памяти и т.д.)
     02h Временная ситуация - нужно повторить попытку позже
     03h Программа не имеет права выполнить требуемое действие
     04h Внутренняя ошибка DOS
     05h Аппаратная ошибка
     06h Системная программная ошибка
     07h Ошибка пользовательской программы
     08h Не обнаружен (например файл)
     09h Неправильный формат
     0Ah Блокировано
     0Bh Media error (ошибка носителя или ошибка CRC)
     0Ch Уже существует
     0Dh Ошибка незнакомого класса
Возможные (рекомендуемые) действия
     01h Новая попытка сразу (Retry)
     02h Новая попытка спустя некоторое время (Delay retry)
     03h Действие пользователя (User) (если пользователь ввел неправиль-
         ное имя устройства, он должен ввести его снова
     04h Прерывание программы с выполнением завершающих процедур (Abort)
     05h Прерывание программы без выполнения завершающих процедур
     06h Игнорирование ошибки (Ignore)
     07h Действие пользователя - например смена дискет
         (Retry after user intervention)

INT 21h, Функция 5Аh - создание временного (уникального) файла
INT 21h, Функция 5Вh - создание нового файла
     На входе: АН - номер функции
               DS:DX - указатель к ASCIIZ-цепочке (файловая спецификация)
               СХ (CL) - атрибуты файла
     На выходе: АХ - код ошибки, если CF=1
                     файловый дескриптор, если CF=0

INT 21h, Функция 5Dh, подфункция 06h - получение адреса области теку-
                      щих данных DOS (недокументирована)
     На входе: AH - 5Dh
               AL - 06h
     На выходе: DS:SI - адрес SDA
                CX - размер в байтах части SDA, которая должна сохра-
                     няться при переходе на другой процесс, если пре-
                     рывается функция DOS
                DX - размер в байтах части SDA, которая должна сохра-
                     няться при переходе на другой процесс во всех
                     случаях
                АХ - код ошибки, если CF=1

INT 21h, Функция 5Dh, подфункция 0Ah - установка расширенной информа-
                                       ции об ошибке
     На входе: AH - 5Dh
               AL - 0Ah
               DS:DX - адрес трехсловного списка параметров, составля-
                       ющих расширенную информацию об ошибке
Позволяет восстановить в SDA расширенную информацию об ошибке, которая
предварительно должна  быть  получена  из  SDA с помощью функции 59h и
сохранена в программе. Функция используется в резидентных обработчиках
аппаратных прерываний.

INT 21h, Функция 62h  - получить идентификатор текущего процесса
     На входе: AH - 62h
     На выходе: BX - сегментный адрес PSP текущего процесса
Возвращает адрес PSP выполняемого в данный момент процесса.

INT 21h, Функция 67h - установить число дескрипторов.
     На входе: AH - 67h
              ВХ - желательное число дескрипторов
     На выходе: в PSP текущей программы записан адрес новой JFT
                АХ - код ошибки, если CF=1
Устанавливает максимальное количество файлов  или  устройств,  которые
могут  быть одновременно открыты с помощью дескрипторов в текущем про-
цессе.  Вызов этой функции управляет размером таблицы  файлов  задания
JFT, которая устанавливает соответствие номеров дескрипторов для теку-
щего процесса и глобальной таблицы DOS для  всех  открытых  в  системе
файлов и устройств. Таблица, действующая по умолчанию, располагается в
резервируемой области PSP процесса и достаточна для хранения 20 однов-
ременно  открытых  дескрипторов.  Новая таблица создается за пределами
программы поэтому необходимо, чтобы в системе был свободный блок памя-
ти соответствующего размера.  Максимальное число открытых файлов опре-
деляется не только размером JFT,  но и числом блоков описания файлов в
системной  таблице SFT,  поэтому,  наряду с расширением JFT необходимо
расширить SFT с помощью директивы файла CONFIG.SYS FILES=.

INT 21h, Функция 68h  -  Сбросить в файл
     На входе: ВХ - дескриптор
     На выходе: АХ - код ошибки, если CF=1
Принудительно (физически) переносит все данные из  внутренних  буферов
системы,  связанных с заданным дескриптором, на устройство. Если деск-
риптор относится к файлу,  а файл модифицировался,  то соответствующея
запись каталога обновляется. Действие этой функции эквивалентно закры-
тию и повторному открытию файла,  или дублированию функцией 45Н  деск-
риптора файла, а затем закрытию дубликата. Функция будет выполняться и
при недостаточном числе дескрипторов, и прикладная программа не риску-
ет потерять управление файлом в многозадачных или сетевых средах.

INT 21h, Функция 69h -получение или установка серийного номера тома.
     На входе: AH - 69h
               AL - 00h - получить серийный номер
                   01h - установить серийный номер
               BL - дисковод
               DS:BX - адрес буфера размером 32 байта
     На выходе:  при AL=00h  в  буфер  помещается копия содержимого
                     расширенного блока параметров BIOS (BPB) на диске
                 при AL=01h в расширенный BPB на диске копируется
                     информация из буфера
                 АХ - код ошибки, если CF=1

INT 21h, Функция 6Ch - расширенное открытие файла
     На входе AL - 00h
              BX - режим открытия
              CX - атрибут файла
              DX - флаг открытия
              DS:SI - адрес пути, заданного в коде ASCIIZ
     На выходе АХ - дескриптор, если CF=0
                    код ошибки, если CF=1
               СХ - 1 - файл существовал и был открыт
                    2 - файл не существовал и был создан
                    3 - файл существовал и был заменен
По данному в коде ASCIIZ пути открывает,  создает и  заменяет  файл  в
указанном  или  действующем по умолчанию каталоге указанного или дейс-
твующего по умолчанию диска. Функция не выполняется, если не существу-
ет какого-либо элемента пути, если файл создается в корневом каталоге,
который переполнен, если в заданном каталоге уже существует файл с тем
же именем,  что и создаваемый файл, и атрибутом только для чтения или,
если программа выполняется в сети,  а пользователь программы имеет не-
достаточные права доступа.
Данная функция об'единяет возможности функций 3СН, 3DH и 5ВН.

INT 25h - абсолютное  чтение  диска
          Обеспечивает непосредственную связь с модулем BIOS  в  целях
          чтения даных из логического сектора диска в память.
INT 26Н - абсолютная  запись  на диск
          Обеспечивает непосредственную  связь  с модулем BIOS в целях
          записи данных в логической сектор диска из памяти.
     На входе: - для доступа к разделам < = 32 Мбайт
                 AL - номер дисковода (0=А, 1=В и т.д.)
                 СХ - число секторов для чтения (записи)
                 DX  - начальный номер сектора
                 DS:BX - адрес буфера
                 для доступа к разделам < 32 Мбайт
                 AL - номер дисковода (0=А, 1=В и т.д.)
                 СХ - -1
                 DS:BX - адрес блока параметров следующего формата:

                         Байты     Описание
                        00Н-03Н  32-битный номер сектора
                        04Н-05Н  число секторов для чтения
                        06Н-07Н  относительный адрес буфера
                        08Н-09Н  сегмент буфера
     На выходе: АХ - код ошибки, если CF=1
Содержимое всех регистров, за исключением сегментных, может быть изме-
нено.
При возвращении из данного прерывания флаги ЦП, первоначально помещен-
ные прерыванием 25h на стек, по-прежнему там и находятся. В целях пре-
дотвращения неуправляемого увеличения стека и обеспечения  доступа  ко
всем другим величинам,  которые были помещены на стек до вызова преры-
вания 25Н,необходимо с помощью команды РОРF или ADD SP,2 очистить стек.
Код ошибки интерпретируется следующим образом:  Младший байт (AL) сов-
падает с кодои ошибки,  возвращаемым в младший байт регистра DI, в тех
случаях, когда запрашивается прерывание 24Н - адрес обработчика крити-
ческой ошибки. Может принимать следующие значения:
     00h - ошибка защиты записи
     01h - неизвестное устройство
     02h - дисковод не готов
     03h - неизвестная команда
     04h - ошибка данных (CRC)
     06h - ошибка позиционирования
     07h - неизвестный тип носителя
     08h - сектор не найден
Старший байт (АН) содержит:
     01Н - неправильная команда
     02Н - неправильная метка адреса
     03Н - попытка записи на защищенный диск (26Н)
     04Н - запрашиваемый сектор не найден
     08Н - не выполнен прямой доступ к памяти
     10Н - ошибка данных
     20Н - не сработал контроллер
     40Н - не выполнена операция установки
     80Н - подсоединенное устройство не среагировало

INT 2Fh - мультиплексное прерывание.
     На входе: AH - функция
              AL - подфункция
     На выходе: AL=0,  если программа не установлена и ее можно
                       установить
                AL=1,  если программа не установлена и ее нельзя
                       установить
                AL=FFh, если программа установлена
                АХ - код ошибки, если CF=1
Прерывание предназначено для организации связи между процессами  и,  в
частности, для обмена информацией с системными и прикладными резидент-
ными программами. Для пользователя зарезервированы функции C0h...FFh.

ПРИЛОЖЕНИЕ. Коды ошибок при выполнении функций DOS

     01h - неправильный номер функции
     02h - файл не найден
     03h - путь не найден
     04h - слишком много открытых файлов
     05h - доступ запрещен
     06h - неправильный дескриптор
     07h - уничтожен блок управления памятью
     08h - нехватка памяти
     09h - неправильный адрес блока памяти
     0Ah - неправильное окружение
     0Bh - неправильный формат
     0Ch - неправильный код доступа
     0Dh - неправильные данные
     0Eh - неизвестное устройство
     0Fh - неправильный дисковод
     10h - попытка удалить текущий каталог
     11h - не то же устройство
     12h - больше нет файлов
     13h - диск с защитой от записи
     14h - неизвестное устройство
     15h - дисковод не готов
     16h - неизвестная команда
     17h - ошибка контрольной суммы
     18h - неверная длина структуры запроса
     19h - ошибка поиска дорожки
     1Ah - неизвестный носитель
     1Bh - сектор не найден
     1Ch - в принтере нет бумаги
     1Dh - отказ записи
     1Eh - отказ чтения
     1Fh - общая ошибка
     20h - нарушение разделения
     21h - нарушение запирания файла
     22h - недопустимая смена дискеты
     23h - отсутствует блок управления файлом FCB
     24h - разделяемый буфер переполнен
     50h - файл уже существует
     52h - каталог не может быть создан
     53h - отказ по прерыванию Int 21h (критическая ошибка)
     54h - слишком много перенаправлений
     55h - двойное перенаправление
     57h - неправильный параметр
